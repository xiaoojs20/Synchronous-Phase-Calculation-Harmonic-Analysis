%分离谐波计算阶跃时间
signal=readmatrix('1_9.csv');

fs=10000; 
ts = 0:0.0001:0.9599;
t=signal(1:end,1);
s=signal(1:end,2);

% s1由谐波分析得到
s1=79.1961141330*sin(2*pi*48.9999958850*ts+150.0003343393/180*pi)+0.0194321801*sin(2*pi*97.3005180148*ts+122.9705573638 /180*pi)...
+0.0450850567*sin(2*pi*146.9568293389*ts+91.9764029533/180*pi)+0.0209452350*sin(2*pi*195.9886094420*ts+90.6690320386/180*pi)...
+0.1368732700*sin(2*pi*244.9993431688*ts+90.0299997064/180*pi)+0.0330251508*sin(2*pi*587.9992963710*ts+90.0263083626/180*pi);

s2=s-s1';
N=9600;
n=0:N-1;
t=n/fs;
figure;
plot(t,s2);